(this.webpackJsonpwidgetory=this.webpackJsonpwidgetory||[]).push([[0],[,,,,,,,,,,,,,,,function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){"use strict";r.r(t);var n=r(0),a=r(1),c=r.n(a),s=r(8),i=r.n(s),o=r(2),d=r(3),l=r(5),u=r(4);r(15),r(16),r(17);function g(e){return Object(n.jsx)(n.Fragment,{children:Object(n.jsx)("button",{className:e.className,onClick:e.onClick,children:e.text})})}r(18);var m=!0,h={action:"idle",money:4e4,mood:{overall:28,r:0,g:0,b:0},unlockedFeatures:{"order-button":!0},timeToNextOrder:12e3,timeUntilOrderCancel:15e4,uncheckedOrders:0,orders:0,widgetParts:8,widgets:0,testedWidgets:0,packages:0,completedOrders:0,timeSinceActionStarted:0,actionSwitchTime:2300,nextAction:void 0,checkOrderTime:3e3,widgetBuildTime:7e3,widgetTestTime:3e3,widgetPackageTime:1200,packageDeliveryTime:12e3,widgetPartPurchaseTime:800,hireWorkerTime:32e3,widgetPrice:1400,widgetPartPrice:850,assignedWorkers:{},unassignedWorkers:0,workerHappiness:70,workerHourlySalary:1300,workerSpeed:.2,consultantLevel:0,salesLevel:0,hrSpecialists:0,workerManagers:0,companyDirectors:0,energyUsed:0,environmentImpact:0,stockPrice:0},b="saveFile01";function p(){var e=localStorage.getItem(b);return null===e?(console.log("Save file not found despite saveFileExists === true!"),h):(console.log(e),JSON.parse(e))}function j(){var e,t=localStorage.getItem(b);if("string"===typeof t){var r=JSON.parse(t);if(void 0!==(e=r)&&null!==e&&"string"===typeof e.action&&"number"===typeof e.money&&"object"===typeof e.mood&&"object"===typeof e.unlockedFeatures&&"number"===typeof e.uncheckedOrders&&"number"===typeof e.orders&&"number"===typeof e.widgets&&"number"===typeof e.testedWidgets&&"number"===typeof e.packages&&"number"===typeof e.completedOrders)return!0;console.log("isGameState false for following saved gameState:\n\n".concat(t))}return!1}function k(){window.confirm("Really hard reset?\nTHIS WILL DELETE ALL SAVED DATA. \n\nPress Cancel/No if unsure.")&&(window.confirm("Please press OK/Yes to be saved.\n (Press No/Cancel if you really really want to delete all your saved data.)")||(localStorage.removeItem(b),localStorage.removeItem("saveFile02"),localStorage.removeItem("saveFile03"),localStorage.removeItem("saveFile04"),window.location.reload()))}var O=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(o.a)(this,r),(n=t.call(this,e)).state={liked:!1},n}return Object(d.a)(r,[{key:"render",value:function(){var e=this;return Object(n.jsxs)("div",{className:"footer-container",children:[Object(n.jsx)(f,{}),Object(n.jsx)(v,{liked:this.state.liked,onClick:function(){return e.setState({liked:!0})}}),Object(n.jsx)("div",{children:"|"}),Object(n.jsx)(g,{text:"Hard reset",onClick:k}),Object(n.jsx)("div",{children:"|"}),Object(n.jsx)("div",{className:"github",children:Object(n.jsx)("a",{href:"https://github.com/mmKALLL/widgetory",target:"_blank",rel:"noopener noreferrer",children:"Github"})}),Object(n.jsx)("div",{children:"|"}),Object(n.jsx)("div",{className:"copyright-notice",children:" \xa9 Esa Koskinen 2019 "})]})}}]),r}(c.a.Component);function v(e){return e.liked?Object(n.jsx)("div",{className:"footer-thanks",children:"Thanks! \u2b50\ufe0f"}):Object(n.jsx)(g,{onClick:e.onClick,text:"Like"})}function f(e){var t=localStorage.getItem("lastSavedAt");if("string"===typeof t&&Date.now()-Date.parse(t)<3500)return Object(n.jsx)(n.Fragment,{children:"Game saved!"});return Object(n.jsx)(n.Fragment,{})}function w(){var e=Math.floor(Math.random()*x.length);return x[e]}var x=["Build the future.","Create your destiny.","You can do this.","You can be successful.","You have what it takes.","Proceed with a kind heart.","You can create anything.","No problem, it's ok.","One widget at a time.","Keep things simple.","Do your best.","\u304c\u3093\u3070\u3063\u3066\u304f\u3060\u3055\u3044\u3002","Stay creative.","Stay true to your goal.","I love you.","Forge on.","Never yield to failure.","Success awaits.","You will evolve.","Compile true love.","Free your mind.","Appreciate everything.","You have profound wisdom.","Just one more widget.","Assembly guides you."];function y(e){return Object(n.jsxs)("div",{className:"main-menu",children:[Object(n.jsx)("h1",{children:"Widgetory"}),Object(n.jsx)(S,{startNewGame:e.startNewGame,startSavedGame:e.startSavedGame}),Object(n.jsx)(O,{})]})}function S(e){return j()?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("div",{className:"text-padded",children:w()}),Object(n.jsx)(g,{className:"button primary-action-button title-button",onClick:e.startSavedGame,text:"Continue building"})]}):Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("div",{className:"text-padded",children:x[0]}),Object(n.jsx)(g,{className:"button primary-action-button title-button",onClick:e.startNewGame,text:"Start building"})]})}var P=r(9);r(19);function T(e){var t=Object(a.useState)(0),r=Object(P.a)(t,2),c=r[0],s=r[1],i=e.text.length,o=function(){return s(c+1)};Object(a.useEffect)((function(){if(!(c>=i)){var t=setInterval(o,e.textScreenTime+2*e.textFadeTime);return function(){return clearInterval(t)}}e.endHandler()}));return Object(n.jsx)(n.Fragment,{children:Object(n.jsx)(C,{text:e.text[c],settings:e})})}function C(e){return Object(n.jsx)(n.Fragment,{children:Object(n.jsx)("div",{className:"cutscene-text",style:{color:e.settings.textColor,backgroundColor:e.settings.bgColor},children:e.text})})}var N=r(6);r(20),r(21);function F(e){return Object(n.jsxs)("span",{className:"action-button-container",children:[Object(n.jsx)(g,{text:e.text,onClick:e.onClick,className:"button primary-action-button"}),e.subtext.split("\n").map((function(e){return Object(n.jsx)("span",{className:"action-button-subtext",children:e},e)}))]})}function A(e){return Object(n.jsxs)("div",{className:"action-panel-wrapper",children:[e.unlockedFeatures["order-button"]&&Object(n.jsx)(F,{text:"Check orders",subtext:"Orders: ".concat(e.orders),onClick:function(){return e.setPlayerAction("check-orders")}}),e.unlockedFeatures["build-button"]&&Object(n.jsx)(F,{text:"Build widgets",subtext:"Parts: ".concat(e.parts,"\nWidgets: ").concat(e.widgets),onClick:function(){return e.setPlayerAction("build-widget")}}),e.unlockedFeatures["test-button"]&&Object(n.jsx)(F,{text:"Test widgets",subtext:"Tested widgets: ".concat(e.testedWidgets),onClick:function(){return e.setPlayerAction("test-widget")}}),e.unlockedFeatures["package-button"]&&Object(n.jsx)(F,{text:"Package widgets",subtext:"Packages: ".concat(e.packages),onClick:function(){return e.setPlayerAction("package-widget")}}),e.unlockedFeatures["deliver-button"]&&Object(n.jsx)(F,{text:"Deliver packages",subtext:"Completed orders: ".concat(e.completedOrders),onClick:function(){return e.setPlayerAction("deliver-packages")}}),e.unlockedFeatures["purchase-parts-button"]&&Object(n.jsx)(F,{text:"Purchase parts",subtext:"Price/unit: ".concat(e.partPrice),onClick:function(){return e.setPlayerAction("purchase-parts")}})]})}var G=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(){var e;Object(o.a)(this,r);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).TEXT_COLOR_SWITCH_THRESHOLD=137,e.TEXT_COLOR_DARK="#111",e.TEXT_COLOR_LIGHT="#eee",e}return Object(d.a)(r,[{key:"moodToRGB",value:function(e){return{r:e.overall+e.r,g:e.overall+e.g,b:e.overall+e.b}}},{key:"textCSSColor",value:function(e){return this.colorBrightness(e)<this.TEXT_COLOR_SWITCH_THRESHOLD?this.TEXT_COLOR_LIGHT:this.TEXT_COLOR_DARK}},{key:"colorBrightness",value:function(e){return Math.sqrt(.299*e.r*e.r+.587*e.g*e.g+.114*e.b*e.b)}},{key:"colorToCSS",value:function(e){var t=Math.floor(e.r),r=Math.floor(e.g),n=Math.floor(e.b);return"rgb(".concat(t,",").concat(r,",").concat(n,")")}},{key:"render",value:function(){var e=this.props.mood,t=this.moodToRGB(e),r=document.documentElement,a=this.colorToCSS(t),c=this.textCSSColor(t);return r.style.setProperty("--mood-background-color",a),r.style.setProperty("--mood-text-color",c),Object(n.jsx)(n.Fragment,{})}}]),r}(c.a.Component);r(22);function W(e){throw new Error("Unexpected object in assertNever:\n  ".concat(e))}Object.keys,Object.entries;function I(e){var t=e.currentAction;return Object(n.jsxs)("div",{children:["You are currently","idle"===t?" idle":"change-action"===t?" context switching":"check-orders"===t?" checking orders":"build-widget"===t?" building a widget":"test-widget"===t?" testing a widget":"package-widget"===t?" packaging a widget":"deliver-packages"===t?" delivering packages":"purchase-parts"===t?" purchasing parts":"hire-worker"===t?" hiring workers":W(t)]})}function L(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#",a=Math.ceil(Math.max(0,Math.min(e,t))/(t+.01)*r);return"\u3010".concat(n.repeat(a)).concat(" ".repeat(r-a),"\u3011")}function M(e){var t=Math.floor(e.state.timeSinceActionStarted/B(e.state)*100);return Object(n.jsxs)("div",{className:"information-panel-container",children:[Object(n.jsx)(I,{currentAction:e.state.action}),Object(n.jsxs)("div",{className:e.state.unlockedFeatures["test-button"]?"action-progress-container":"hidden",children:["Progress:",Object(n.jsx)("pre",{className:"action-progress-bar",children:L(t,100)})," ".concat(t,"%"),B(e.state)<6e5&&" (".concat(Math.floor((B(e.state)-e.state.timeSinceActionStarted+1e3)/1e3)," sec)")]}),Object(n.jsx)("div",{className:e.state.unlockedFeatures["build-button"]||e.state.unlockedFeatures["purchase-parts-button"]?"information-panel-divider":"hidden"}),Object(n.jsxs)("div",{className:e.state.unlockedFeatures["build-button"]||e.state.unlockedFeatures["purchase-parts-button"]?"money-text":"hidden",children:["Money: ",e.state.money]}),Object(n.jsxs)("div",{className:e.state.consultantLevel>=2?"order-cancel-text":"hidden",children:["Time until order cancel: ",Math.floor(e.state.timeUntilOrderCancel/1e3)," sec"]}),Object(n.jsxs)("div",{className:e.state.unlockedFeatures["purchase-parts-button"]?"widget-part-price-text":"hidden",children:["Widget part purchase price: ",e.state.widgetPartPrice]}),Object(n.jsxs)("div",{className:e.state.unlockedFeatures["deliver-button"]?"widget-price-text":"hidden",children:["Widget sell price: ",e.state.widgetPrice]})]})}var E=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(o.a)(this,r),(n=t.call(this,e)).setPlayerAction=function(e){e===n.state.action?n.setState({action:"idle"}):n.setState({action:"change-action",nextAction:e,timeSinceActionStarted:0})},n.updateGameState=function(){n.setState(H)},n.payWorkerSalaries=function(){n.setState(D)},n.state=e.initialState,window.setInterval(n.updateGameState,20),window.setInterval((function(){return function(e){var t=JSON.stringify(e);localStorage.setItem(b,t),localStorage.setItem("lastSavedAt",Date.now().toString()),console.log("game saved")}(n.state)}),1e4),window.setInterval(n.payWorkerSalaries,6e4),n}return Object(d.a)(r,[{key:"render",value:function(){return Object(n.jsxs)("div",{className:"game-container",children:[Object(n.jsx)(M,{debugEnabled:m,state:this.state}),Object(n.jsx)(A,{orders:this.state.orders,parts:this.state.widgetParts,widgets:this.state.widgets,testedWidgets:this.state.testedWidgets,packages:this.state.packages,completedOrders:this.state.completedOrders,partPrice:this.state.widgetPartPrice,setPlayerAction:this.setPlayerAction,unlockedFeatures:this.state.unlockedFeatures}),Object(n.jsx)(O,{}),Object(n.jsx)(G,{mood:this.state.mood})]})}}]),r}(c.a.Component),H=function(e,t){var r=Object(N.a)({},e);r.timeToNextOrder-=20,r.timeToNextOrder<0&&(r.uncheckedOrders+=1,r.timeToNextOrder=R(r.completedOrders)),r.timeSinceActionStarted+=20;var n=B(r);if("idle"!==r.action&&r.timeSinceActionStarted>=n)switch(r.timeSinceActionStarted-=n,r.action){case"change-action":r.action=void 0!==r.nextAction?r.nextAction:"idle",r.nextAction=void 0,r.timeSinceActionStarted=0;break;case"check-orders":console.log("got ".concat(r.uncheckedOrders," new orders, received ").concat(r.uncheckedOrders*r.widgetPrice," yen")),r.orders+=r.uncheckedOrders,r.money+=r.uncheckedOrders*r.widgetPrice,r.uncheckedOrders=0;break;case"build-widget":r.widgetParts>0&&(r.energyUsed+=2,r.widgets+=1,r.widgetParts-=1);break;case"test-widget":r.widgets>0&&(r.energyUsed+=.6,r.testedWidgets+=1,r.widgets-=1);break;case"package-widget":r.testedWidgets>0&&(r.packages+=1,r.testedWidgets-=1);break;case"deliver-packages":var a=Math.min(r.orders,r.packages);console.log("delivering ".concat(a," packages")),r.orders-=a,r.completedOrders+=a,r.timeUntilOrderCancel+=R(r.completedOrders)*a,r.packages-=a,r.widgetPrice-=a,r.action="idle";break;case"purchase-parts":r.money>=r.widgetPartPrice&&(r.widgetParts+=1,r.money-=r.widgetPartPrice);break;case"hire-worker":r.money>=r.workerHourlySalary&&(r.unassignedWorkers+=1)}return r.timeUntilOrderCancel-=20,r.timeUntilOrderCancel<0&&(r.orders>0?(r.orders-=1,r.money-=r.widgetPrice,console.log("cancelled order, lost ".concat(r.widgetPrice," yen, ").concat(r.orders," checked and ").concat(r.uncheckedOrders," unchecked left, next in ").concat(U(r.completedOrders,r.orders+r.uncheckedOrders)/1e3," seconds"))):(r.uncheckedOrders-=1,console.log("cancelled unchecked order, lost no yen, ".concat(r.orders," checked and ").concat(r.uncheckedOrders," unchecked left, next in ").concat(U(r.completedOrders,r.orders+r.uncheckedOrders)/1e3," seconds"))),r.timeUntilOrderCancel=U(r.completedOrders,r.orders+r.uncheckedOrders)),Math.random()<1/(r.completedOrders/1e3+1e3)&&(r.widgetPrice+=Math.floor((Math.random()-.3)*((8457-r.widgetPrice)/100)),console.log("widget price changed to ".concat(r.widgetPrice))),Math.random()<1/(r.widgetParts+1e3)&&(r.widgetPartPrice-=Math.floor((Math.random()-.3)*((128+r.widgetPartPrice)/100)),console.log("widget part price changed to ".concat(r.widgetPartPrice))),r.unlockedFeatures=Object(N.a)({},r.unlockedFeatures),r.orders>0&&!r.unlockedFeatures["build-button"]&&(r.action="idle",r.unlockedFeatures["build-button"]=!0),r.widgets>=3&&(r.unlockedFeatures["test-button"]=!0),r.testedWidgets>=3&&(r.unlockedFeatures["package-button"]=!0),r.packages>0&&(r.unlockedFeatures["deliver-button"]=!0),0===r.widgetParts&&(r.unlockedFeatures["purchase-parts-button"]=!0),7===r.completedOrders&&(r.unlockedFeatures["hire-worker-button"]=!0),r.unassignedWorkers>0&&(r.unlockedFeatures["assign-worker-buttons"]=!0),r},D=function(e,t){var r=Object(N.a)({},e);return r.money-=(r.unassignedWorkers+_(r))*r.workerHourlySalary/60,r},_=function(e){return Object.values(e.assignedWorkers).map((function(e){return null!==e&&void 0!==e?e:0})).reduce((function(e,t){return e+t}),0)},R=function(e){return 1e6/(e+40)},U=function(e,t){return 12e8/(e+1e4)/Math.pow(t+1,.7)},B=function(e){switch(e.action){case"change-action":return e.actionSwitchTime;case"check-orders":return e.checkOrderTime;case"build-widget":return e.widgetBuildTime;case"test-widget":return e.widgetTestTime;case"package-widget":return e.widgetPackageTime;case"deliver-packages":return e.packageDeliveryTime;case"purchase-parts":return e.widgetPartPurchaseTime;case"hire-worker":return e.hireWorkerTime;default:return 1e10}},Y=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(o.a)(this,r),(n=t.call(this,e)).startNewGame=function(){console.log("start intro"),n.setState({screenName:"intro"})},n.startSavedGame=function(){n.setState({screenName:"in-game-widget",loadSavedGame:!0})},n.finishIntro=function(){n.setState({screenName:"in-game-widget",loadSavedGame:!1})},n.state={screenName:"main-menu"},n}return Object(d.a)(r,[{key:"render",value:function(){return"main-menu"===this.state.screenName?Object(n.jsx)(y,{startNewGame:this.startNewGame,startSavedGame:this.startSavedGame}):"intro"===this.state.screenName?Object(n.jsx)(T,{text:["Money Match Games presents \u2728","The 47th Studio Esagames production","This game is a product of fiction.","Any similarity to real-world names, places, or events is purely coincidental.","Not suitable for children or those who are easily disturbed."],textFadeTime:250,textScreenTime:600,bgColor:"#fff",textColor:"#111",endHandler:this.finishIntro}):"in-game-widget"===this.state.screenName?Object(n.jsx)(E,{initialState:this.state.loadSavedGame?p():h}):Object(n.jsx)(n.Fragment,{children:"error in GameScreen state, please post issue at https://github.com/mmKALLL/widgetry"})}}]),r}(c.a.Component),J=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(d.a)(r,[{key:"render",value:function(){return Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)("link",{href:"https://fonts.googleapis.com/css?family=Charm|Gloria+Hallelujah|Noto+Sans+JP|Roboto+Slab",rel:"stylesheet"}),Object(n.jsx)(Y,{})]})}}]),r}(a.Component);r(23);i.a.render(Object(n.jsx)(J,{}),document.getElementById("root"))}],[[24,1,2]]]);
//# sourceMappingURL=main.7208ba66.chunk.js.map